---
title: Portfolio Optimization
module: advanced
order: 5
colabUrl: ""
prerequisites:
  - advanced/04-orthogonal-dimensions
---

# Portfolio Optimization

Portfolio optimization finds the best allocation across assets or strategies. The goal: maximize return for a given level of risk.

<ConceptCard title="Mean-Variance Optimization" type="definition">
**Markowitz optimization** finds portfolios that maximize expected return for a given volatility (or minimize volatility for a given return). The set of optimal portfolios forms the **efficient frontier**.
</ConceptCard>

## The Efficient Frontier

<FormulaDisplay
  formula="\max_w \; w^T \mu - \frac{\lambda}{2} w^T \Sigma w"
  explanation="Maximize return minus a penalty for variance."
  variables={[
    { symbol: "w", meaning: "Portfolio weights" },
    { symbol: "\\mu", meaning: "Expected returns vector" },
    { symbol: "\\Sigma", meaning: "Covariance matrix" },
    { symbol: "\\lambda", meaning: "Risk aversion parameter" }
  ]}
/>

<InteractiveExample title="Efficient Frontier" description="Optimal portfolios for different risk levels">
  <EfficientFrontier
    frontier={[
      { risk: 5.2, return: 3.8 },
      { risk: 5.8, return: 4.9 },
      { risk: 6.5, return: 5.8 },
      { risk: 7.4, return: 6.7 },
      { risk: 8.5, return: 7.5 },
      { risk: 9.8, return: 8.2 },
      { risk: 11.2, return: 8.8 },
      { risk: 12.8, return: 9.3 },
      { risk: 14.5, return: 9.7 },
      { risk: 16.4, return: 10.1 },
      { risk: 18.5, return: 10.4 },
      { risk: 20.8, return: 10.6 }
    ]}
    assets={[
      { name: "US Bonds", risk: 5.5, return: 3.2 },
      { name: "Corp Bonds", risk: 7.8, return: 4.5 },
      { name: "US Stocks", risk: 16.2, return: 9.8 },
      { name: "Intl Stocks", risk: 18.5, return: 8.9 },
      { name: "EM Stocks", risk: 23.4, return: 10.2 },
      { name: "REITs", risk: 19.1, return: 8.4 },
      { name: "Gold", risk: 15.3, return: 5.1 }
    ]}
    optimalPortfolio={{ risk: 9.8, return: 8.2, sharpe: 0.84 }}
    riskFreeRate={2.0}
    showCML={true}
    title="Efficient Frontier with Individual Assets"
    subtitle="Tangency portfolio maximizes Sharpe ratio"
  />
</InteractiveExample>

## The Perils of Optimization

<ConceptCard title="Estimation Error" type="warning">
Optimization is only as good as your inputs. Small errors in expected returns cause **huge changes** in optimal weights. The optimizer "maximizes errors" - putting big bets on assets with overestimated returns.

**Result**: Optimized portfolios often perform worse than simple equal-weight!
</ConceptCard>

<InteractiveExample title="Estimation Error Impact" description="Small errors in return estimates cause large swings in optimal weights">
  <SensitivityHeatmap
    data={{
      param1Values: [-1.0, -0.5, 0, 0.5, 1.0],
      param1Label: "Return Estimate Error (%)",
      param2Values: [1, 2, 3],
      param2Label: "Asset",
      results: [
        [72, 58, 40, 22, 8],
        [18, 24, 30, 38, 52],
        [10, 18, 30, 40, 40]
      ],
      metricLabel: "Optimal Weight (%)"
    }}
    title="Optimal Weights vs Return Estimate Errors"
    subtitle="Notice how a 1% error flips the allocation dramatically"
  />
</InteractiveExample>

## Robust Approaches

<ConceptCard title="Better Than MVO" type="tip">
**Practical alternatives to mean-variance:**
- **Equal weight**: No estimation, surprisingly hard to beat
- **Risk parity**: Weight by inverse volatility
- **Minimum variance**: Ignore returns, just minimize vol
- **Shrinkage**: Pull estimates toward a prior (e.g., equal returns)
- **Black-Litterman**: Combine market equilibrium with views
</ConceptCard>

<FormulaDisplay
  formula="w_i^{RP} = \frac{1/\sigma_i}{\sum_j 1/\sigma_j}"
  explanation="Risk parity weights by inverse volatility."
  variables={[
    { symbol: "w_i^{RP}", meaning: "Risk parity weight" },
    { symbol: "\\sigma_i", meaning: "Asset volatility" }
  ]}
/>

<InteractiveExample title="Optimization Method Comparison" description="Simple methods often beat complex optimization">
  <LineChart
    data={[
      { x: 2015, y: 100, y2: 100, y3: 100 },
      { x: 2016, y: 108, y2: 106, y3: 110 },
      { x: 2017, y: 118, y2: 115, y3: 122 },
      { x: 2018, y: 112, y2: 111, y3: 115 },
      { x: 2019, y: 130, y2: 125, y3: 132 },
      { x: 2020, y: 145, y2: 138, y3: 140 },
      { x: 2021, y: 165, y2: 155, y3: 158 },
      { x: 2022, y: 155, y2: 150, y3: 148 }
    ]}
    xLabel="Year"
    yLabel="Portfolio Value"
    title="Equal Weight vs MVO vs Risk Parity"
    series={[
      { key: "y", name: "Equal Weight", color: "#10b981" },
      { key: "y2", name: "Mean-Variance", color: "#ef4444" },
      { key: "y3", name: "Risk Parity", color: "#3b82f6" }
    ]}
  />
</InteractiveExample>

<KeyTakeaway>
Mean-variance optimization is theoretically elegant but practically fragile due to **estimation error**. Simpler approaches like **equal weight** or **risk parity** often outperform. If using optimization, apply **shrinkage** and **constraints** to improve robustness.
</KeyTakeaway>
