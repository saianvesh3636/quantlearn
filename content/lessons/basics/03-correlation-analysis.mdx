---
title: Correlation Analysis
module: basics
order: 3
colabUrl: ""
prerequisites:
  - basics/02-descriptive-statistics
---

# Correlation Analysis

Correlation measures how assets move together. Understanding correlation is essential for portfolio diversification and risk management.

<WhyItMatters tldr="Correlation assumptions are the #1 reason sophisticated investors blow up. When correlations spike in a crisis, your 'diversified' portfolio can lose 50% instead of the 20% you planned for.">
Every portfolio optimization, every risk model, every hedge relies on correlation estimates. But here's the trap: **correlations measured in calm markets don't hold in crises**. The very moment you need diversification to protect you is exactly when it fails. Understanding this isn't optional - it's the difference between surviving a crash and being wiped out.
</WhyItMatters>

<ConceptCard title="Why Correlation Matters" type="definition">
If two assets are perfectly correlated, owning both gives no diversification benefit. **Diversification works when correlations are low** - your losses in one asset are offset by gains in another.
</ConceptCard>

## Covariance

<FormulaDisplay
  formula="Cov(X, Y) = \frac{1}{n-1}\sum_{i=1}^{n}(X_i - \bar{X})(Y_i - \bar{Y})"
  explanation="Covariance measures how two variables move together."
  variables={[
    { symbol: "Cov(X,Y)", meaning: "Covariance between X and Y" },
    { symbol: "Cov > 0", meaning: "Variables move in same direction" },
    { symbol: "Cov < 0", meaning: "Variables move in opposite directions" }
  ]}
/>

<ConceptCard title="Covariance Problem" type="warning">
Covariance is hard to interpret because it depends on the units/scale of the variables. A covariance of 50 - is that high or low? We need **correlation** to standardize.
</ConceptCard>

## Correlation Coefficient

<FormulaDisplay
  formula="\rho_{X,Y} = \frac{Cov(X, Y)}{\sigma_X \sigma_Y}"
  explanation="Correlation standardizes covariance to range from -1 to +1."
  variables={[
    { symbol: "\\rho = +1", meaning: "Perfect positive correlation" },
    { symbol: "\\rho = 0", meaning: "No linear relationship" },
    { symbol: "\\rho = -1", meaning: "Perfect negative correlation" }
  ]}
/>

<InteractiveExample title="Correlation Examples" description="Scatter plots showing different correlation levels">
  <ScatterPlot
    data={[
      { x: -2, y: -1.8, label: "" },
      { x: -1, y: -0.5, label: "" },
      { x: 0, y: 0.2, label: "" },
      { x: 1, y: 1.1, label: "" },
      { x: 2, y: 2.3, label: "" },
      { x: -1.5, y: -1.2, label: "" },
      { x: 0.5, y: 0.8, label: "" },
      { x: 1.5, y: 1.7, label: "" }
    ]}
    xLabel="Asset A Return (%)"
    yLabel="Asset B Return (%)"
    title="High Positive Correlation (ρ ≈ 0.9)"
    showRegression={true}
    showCorrelation={true}
  />
</InteractiveExample>

## Correlation Matrix

<ConceptCard title="Multi-Asset Correlations" type="tip">
With multiple assets, we use a **correlation matrix** to see all pairwise correlations at once. The diagonal is always 1 (asset correlated with itself). Look for low/negative correlations for diversification.
</ConceptCard>

<InteractiveExample title="Asset Correlation Matrix" description="Pairwise correlations between asset classes">
  <Heatmap
    data={{
      rowLabels: ["US Stocks", "Int'l Stocks", "Bonds", "Gold"],
      columnLabels: ["US Stocks", "Int'l Stocks", "Bonds", "Gold"],
      data: [
        [1.0, 0.85, -0.2, 0.05],
        [0.85, 1.0, -0.1, 0.15],
        [-0.2, -0.1, 1.0, 0.3],
        [0.05, 0.15, 0.3, 1.0]
      ]
    }}
    title="Asset Class Correlation Matrix"
    diverging={true}
    showValues={true}
  />
</InteractiveExample>

## Correlation Instability

<ConceptCard title="Correlations Change" type="warning">
**Correlation is not constant!** During market crises, correlations spike - everything falls together. This is exactly when you need diversification most, but it fails. This is called **correlation breakdown**.
</ConceptCard>

<InteractiveExample title="Correlation During Crisis" description="Correlations spike during market stress">
  <LineChart
    data={[
      { x: 2018, y: 0.65 },
      { x: 2019, y: 0.60 },
      { x: 2020, y: 0.92 },
      { x: 2021, y: 0.70 },
      { x: 2022, y: 0.75 },
      { x: 2023, y: 0.62 }
    ]}
    xLabel="Year"
    yLabel="Stock-Bond Correlation"
    title="Stock-Bond Correlation Spikes in Crisis (2020)"
    series={[
      { key: "y", name: "Correlation", color: "#ef4444" }
    ]}
  />
</InteractiveExample>

## Real-World Disasters: When Correlations Broke

<RealWorldExample
  title="Long-Term Capital Management (LTCM) Collapse"
  date="August 1998"
  impact="$4.6 billion loss, Federal Reserve bailout"
  sources={[
    { name: "Federal Reserve History", url: "https://www.federalreservehistory.org/essays/ltcm-near-failure" },
    { name: "Journal of Economic Perspectives" }
  ]}
  lesson="Diversification based on historical correlations can fail catastrophically when market regimes change."
>
LTCM was run by Nobel Prize winners and had the most sophisticated risk models of its time. They held **$125 billion in leveraged positions** across "uncorrelated" markets worldwide.

**What happened:** Russia defaulted on its debt in August 1998, triggering a global "flight to quality." Suddenly, every market moved in the same direction - investors sold *everything* to buy US Treasuries.

**The correlation spike:** Markets that had been uncorrelated for years became perfectly correlated overnight. LTCM's "diversified" portfolio lost most of its value in weeks. The Federal Reserve had to coordinate a $3.6 billion bailout to prevent systemic collapse.

**The fatal flaw:** Their models assumed historical correlations would hold. They didn't account for the fact that in a panic, **all correlations go to 1**.
</RealWorldExample>

<RealWorldExample
  title="2008 Financial Crisis: Diversification Failure"
  date="September-October 2008"
  impact="Correlations spiked from 40% to 70%"
  sources={[
    { name: "Financial Analysts Journal - When Diversification Fails", url: "https://www.tandfonline.com/doi/full/10.2469/faj.v74.n3.3" },
    { name: "Two Sigma Research" }
  ]}
  lesson="Always stress-test portfolios using crisis-period correlations, not calm-period averages."
>
During the 2008 crisis, researchers documented a dramatic correlation breakdown:

- **Pre-crisis:** Pairwise equity correlations averaged ~40%
- **During crisis:** Correlations spiked to nearly 70%
- **Principal components:** The first 3 PCs explained 90% of variation (vs typical 60-70%)

A "diversified" portfolio of US stocks, international stocks, emerging markets, and REITs saw its effective beta to equities rise from 0.65 to 0.95. The diversification benefit evaporated precisely when it was needed most.

**Result:** The portfolio underperformed a simple 60/40 stock/bond mix by 9 percentage points - diversification made things *worse*, not better.
</RealWorldExample>

<KeyTakeaway>
Correlation measures co-movement between assets. **Low correlations** enable diversification. Use **correlation matrices** to visualize relationships. But beware: **correlations spike during crises** when you need diversification most.
</KeyTakeaway>

<FindYourEdge
  concept="Correlation & Diversification"
  strategies={[
    {
      name: "Dispersion Trading (Correlation Premium)",
      description: "Implied correlation (from index options) consistently exceeds realized correlation. Sell index volatility and buy single-stock volatility to harvest this premium.",
      implementation: "Sell ATM straddle on S&P 500 index. Buy ATM straddles on weighted basket of component stocks. Delta-hedge the combined portfolio. Profit when realized correlation is lower than implied.",
      parameters: "Entry when implied correlation > 0.6. Exit when spread normalizes. Use weighting proportional to index weights.",
      evidence: "Driessen, Maenhout & Vilkov found 18-point correlation risk premium (1996-2003). CBOE launched DSPX index in 2023 to track dispersion opportunities.",
      risks: "BLOW-UP RISK: During market stress (2008, 2020), correlations spike to 1.0 and you lose on both legs. Requires significant capital and options expertise. Premium has compressed as more participants entered."
    },
    {
      name: "Crisis-Period Stress Testing",
      description: "Use crisis-period correlations (not average) for portfolio construction to build truly resilient portfolios.",
      implementation: "Calculate correlations from 2008-2009, March 2020, and other crisis periods. Use these higher correlations for risk budgeting. Add truly uncorrelated assets: managed futures, gold, long volatility.",
      parameters: "Use correlation matrix from worst 5% of market days, not all days. Assume equity-like assets reach 0.8+ correlation in crises.",
      evidence: "Page & Panariello (2018 FAJ) showed diversified portfolios underperformed 60/40 by 9% in 2008 due to correlation spikes. Crisis correlations are more predictive of tail risk.",
      risks: "Portfolio will be more conservative and may underperform in normal times. Truly uncorrelated assets (trend following) often have negative expected returns as the cost of protection."
    }
  ]}
/>

<ThinkAboutIt questions={[
  {
    question: "If you know correlations spike during crises, how would you build a portfolio that actually protects you when it matters?",
    hint: "Consider using crisis-period correlations for stress tests, holding assets that are truly uncorrelated (like trend-following strategies), or accepting that diversification has limits and using options for tail protection instead."
  },
  {
    question: "Why do you think correlations increase during market panics? What's the behavioral/mechanical explanation?",
    hint: "During panics, investors sell everything to raise cash (forced liquidation). Margin calls force selling regardless of fundamentals. Everyone runs for the same exit at the same time."
  },
  {
    question: "LTCM had Nobel Prize winners and sophisticated models. What does their failure teach us about the limits of quantitative finance?",
    hint: "Models are based on historical data. History doesn't repeat exactly. 'Fat tail' events that are supposed to happen once in 10,000 years happen much more often. Leverage amplifies both gains AND model errors."
  }
]} />
